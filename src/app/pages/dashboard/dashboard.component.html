<nav class="top-links">
    <a class="nav-link nav-left" routerLink="/history">
        <span class="arrow">โ</span>
        <span class="text">ุณุฌู ุงูููุงุนูุฏ</span>
    </a>
    <a class="nav-link nav-right" routerLink="/home">
        <span class="text">ุงูุฑุฆูุณูุฉ</span>
        <span class="arrow">โ</span>
    </a>
</nav>

<section>


    <div class="container-fluid">
        <div *ngIf="showWeeklyAlert" class="alert alert-warning alert-dismissible fade show my-5" role="alert">
            <strong>๐ข ุชุฐููุฑ!</strong> ููุถู ูุณุญ ุงูุณุฌูุงุช ุงูุฎุงุตุฉ ุจุงูุฃุณุจูุน ุงูุญุงูู.
            <button type="button" class="btn-close" aria-label="Close" (click)="dismissAlert()"></button>
        </div>




        <section class="dashboard-section">
            <div class="count-box shadow-sm p-4 bg-white rounded">
                <h5 class="text-secondary">ุฅุฌูุงูู ุญุฌูุฒุงุช ุงูููู</h5>
                <h2 class="fw-bold text-danger">{{ totalCount }}</h2>
            </div>
        </section>


        <div class="top-actions-wrap">
            <div class="left-actions">
                <!-- ุฒุฑุงุฑ ูุชุญ/ุฅุบูุงู ู ุชุฃุฌูู ุนูู ุงูุดูุงู -->
                <!-- ุฒุฑุงุฑ ูุชุญ / ุฅุบูุงู ุงูุญุฌุฒ -->
                <button class="btn btn-soft" id="toggleBookingBtn" title="ูุชุญ ุฃู ุฅุบูุงู ุงูุญุฌุฒ" data-bs-toggle="modal"
                    data-bs-target="#changeBookingModal2">

                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <rect x="2" y="7" width="20" height="10" rx="5" stroke="currentColor" stroke-width="1.6" />
                        <circle cx="9" cy="12" r="3" fill="currentColor" />
                    </svg>

                    ูุชุญ / ุฅุบูุงู ุงูุญุฌุฒ ูุน ูุณุญ ุงูุญุฌูุฒุงุช
                </button>

                <!-- ุงูููุฏุงู -->
                <div class="modal fade" id="changeBookingModal2" tabindex="-1" aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content">

                            <!-- Header -->
                            <div class="modal-header">
                                <h5 class="modal-title">ุชุบููุฑ ุญุงูุฉ ุงูุญุฌุฒ</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"
                                    aria-label="ุฅุบูุงู"></button>
                            </div>

                            <!-- Body -->
                            <div class="modal-body">
                                <div class="alert alert-warning text-center" role="alert">
                                    ููููู ูุชุญ ุฃู ุฅุบูุงู ุงูุญุฌุฒ ููููู ุงูุญุงูู ุฃู ููููู ุงูุชุงูู ููุท
                                </div>

                                <div class="mb-3">
                                    <label for="day" class="form-label">ุงูููู</label>
                                    <input type="date" class="form-control" id="day" [(ngModel)]="selectedDay"
                                        name="day">
                                </div>

                                <div *ngIf="statusMessage" class="alert text-center"
                                    [ngClass]="{'alert-success': statusSuccess, 'alert-danger': !statusSuccess}">
                                    {{ statusMessage }}
                                </div>
                            </div>

                            <!-- Footer -->
                            <div class="modal-footer">
                                <button type="button" class="btn btn-success" (click)="changeDayStatus(false)"
                                    data-bs-dismiss="modal">
                                    ูุชุญ ุงูุญุฌุฒ
                                </button>

                                <button type="button" class="btn-close-book" (click)="changeDayStatus(true)"
                                    data-bs-dismiss="modal">
                                    ุฅุบูุงู ุงูุญุฌุฒ
                                </button>
                            </div>
                        </div>
                    </div>
                </div>







                <!-- ุฒุฑุงุฑ ูุชุญ / ุฅุบูุงู ุงูุญุฌุฒ -->
                <button class="btn btn-soft" id="toggleBookingBtn2" title="ูุชุญ ุฃู ุฅุบูุงู ุงูุญุฌุฒ" data-bs-toggle="modal"
                    data-bs-target="#changeBookingModal3">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <rect x="2" y="7" width="20" height="10" rx="5" stroke="currentColor" stroke-width="1.6" />
                        <circle cx="9" cy="12" r="3" fill="currentColor" />
                    </svg>
                    ูุชุญ / ุฅุบูุงู ุงูุญุฌุฒ ุจุฏูู ูุณุญ ุงูุญุฌูุฒุงุช
                </button>

                <!-- ุงูููุฏุงู -->
                <div class="modal fade" id="changeBookingModal3" tabindex="-1" aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content">

                            <!-- Header -->
                            <div class="modal-header">
                                <h5 class="modal-title">ุชุบููุฑ ุญุงูุฉ ุงูุญุฌุฒ</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"
                                    aria-label="ุฅุบูุงู"></button>
                            </div>

                            <!-- Body -->
                            <div class="modal-body">
                                <div class="alert alert-warning text-center" role="alert">
                                    ููููู ูุชุญ ุฃู ุฅุบูุงู ุงูุญุฌุฒ ููููู ุงูุญุงูู ุฃู ููููู ุงูุชุงูู ููุท
                                </div>

                                <!-- ุงุฎุชูุงุฑ ุงูููู -->
                                <div class="mb-3">
                                    <label for="day2" class="form-label">ุงูููู</label>
                                    <input type="date" class="form-control" id="day2" [(ngModel)]="selectedDay2"
                                        name="day2">
                                </div>

                                <!-- ุนุฑุถ ุญุงูุฉ ุงูุนูููุฉ -->
                                <div *ngIf="statusMessage2" class="alert text-center"
                                    [ngClass]="{'alert-success': statusSuccess2, 'alert-danger': !statusSuccess2}">
                                    {{ statusMessage2 }}
                                </div>
                            </div>

                            <!-- Footer -->
                            <div class="modal-footer">
                                <button type="button" class="btn btn-success" (click)="changeDayStatus2(false)"
                                    data-bs-dismiss="modal">
                                    ูุชุญ ุงูุญุฌุฒ
                                </button>
                                <button type="button" class="btn-close-book" (click)="changeDayStatus2(true)"
                                    data-bs-dismiss="modal">
                                    ุฅุบูุงู ุงูุญุฌุฒ
                                </button>
                            </div>
                        </div>
                    </div>
                </div>




                <!-- ุฒุฑุงุฑ ุชุฃุฌูู ุงูููุนุงุฏ -->
                <button class="btn btn-ghost" id="postponeBtn" title="ุชุฃุฌูู ุงูููุนุงุฏ" data-bs-toggle="modal"
                    data-bs-target="#rescheduleModal">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="12" cy="12" r="9" stroke="currentColor" stroke-width="2" />
                        <path d="M12 6v6l4 2" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                            stroke-linejoin="round" />
                        <path d="M21 3v4h-4" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                            stroke-linejoin="round" />
                        <path d="M3 21v-4h4" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                            stroke-linejoin="round" />
                    </svg>
                    ุชุฃุฌูู ุงูููุนุงุฏ ูููุณ ุงูููู
                </button>

                <!-- Modal: Reschedule -->
                <div class="modal fade" id="rescheduleModal" tabindex="-1" aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content">

                            <!-- Header -->
                            <div class="modal-header">
                                <h5 class="modal-title">ุชุฃุฌูู / ุฅุนุงุฏุฉ ุฌุฏููุฉ ุงูููุนุฏ</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"
                                    aria-label="ุฅุบูุงู"></button>
                            </div>

                            <!-- Body -->
                            <div class="modal-body">
                                <form>

                                    <!-- ุงุฎุชูุงุฑ ุงูููุนุฏ -->
                                    <div class="mb-3">
                                        <label for="appointmentId" class="form-label">ุงุฎุชุฑ ุงูููุนุฏ</label>
                                        <select class="form-select" id="appointmentId"
                                            [(ngModel)]="selectedAppointmentId" name="appointmentId">
                                            <option *ngFor="let app of rows" [value]="app.id">
                                                {{ app.patientName }} - {{ app.date }} - {{ app.estimatedTime }}
                                            </option>
                                        </select>
                                    </div>


                                    <!-- ุงุฎุชูุงุฑ ุงูุชุงุฑูุฎ ุงูุฌุฏูุฏ -->
                                    <div class="mb-3">
                                        <label for="newDate" class="form-label">ุงูููู ุงูุฌุฏูุฏ</label>
                                        <input type="date" class="form-control" id="newDate" [(ngModel)]="newDate"
                                            name="newDate">
                                    </div>

                                    <!-- ุงุฎุชูุงุฑ ุงูููุช ุงูุฌุฏูุฏ -->
                                    <div class="mb-3">
                                        <label for="newTime" class="form-label">ุงูููุช ุงูุฌุฏูุฏ</label>
                                        <div class="input-group">
                                            <input id="newTime" class="form-control" [(ngModel)]="selectedNewTime"
                                                name="newTime" placeholder="ุงุฎุชุฑ ุงูููุช">

                                            <!-- <select class="form-select w-auto" [(ngModel)]="selectedPeriod"
                                                name="period">
                                                <option value="AM">AM</option>
                                                <option value="PM">PM</option>
                                            </select> -->
                                        </div>
                                    </div>


                                </form>
                            </div>

                            <!-- Footer -->
                            <div class="modal-footer">
                                <button type="button" class="btn-close-book" data-bs-dismiss="modal">
                                    ุฅูุบุงุก
                                </button>
                                <button type="button" class="btn btn-primary text-white" (click)="reschedule()"
                                    data-bs-dismiss="modal">
                                    ุชุฃููุฏ ุงูุชุฃุฌูู
                                </button>
                            </div>
                        </div>
                    </div>
                </div>






                <!-- ุฒุฑุงุฑ ุชุฃุฌูู ุงูููุนุงุฏ ูููู ุขุฎุฑ -->
                <button class="btn btn-ghost" id="postponeOtherDayBtn" title="ุชุฃุฌูู ุงูููุนุงุฏ ูููู ุขุฎุฑ"
                    data-bs-toggle="modal" data-bs-target="#rescheduleOtherDayModal">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <rect x="4" y="4" width="16" height="16" rx="2" stroke="currentColor" stroke-width="2" />
                        <path d="M8 12h8M12 8v8" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                    </svg>
                    ุชุฃุฌูู ุงูููุนุงุฏ ูููู ุขุฎุฑ
                </button>

                <!-- Modal: Reschedule Other Day -->
                <div class="modal fade" id="rescheduleOtherDayModal" tabindex="-1" aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content">

                            <!-- Header -->
                            <div class="modal-header">
                                <h5 class="modal-title">ุชุฃุฌูู ุงูููุนุงุฏ ูููู ุขุฎุฑ</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"
                                    aria-label="ุฅุบูุงู"></button>
                            </div>

                            <!-- Body -->
                            <div class="modal-body">
                                <form>
                                    <!-- ุงุฎุชูุงุฑ ุงูููุนุฏ -->
                                    <div class="mb-3">
                                        <label for="appointmentIdOtherDay" class="form-label">ุงุฎุชุฑ ุงูููุนุฏ</label>
                                        <select class="form-select" id="appointmentIdOtherDay"
                                            [(ngModel)]="selectedAppointmentIdOtherDay" name="appointmentIdOtherDay">
                                            <option *ngFor="let app of rows" [value]="app.id">
                                                {{ app.patientName }} - {{ app.date }} - {{ app.estimatedTime }}
                                            </option>
                                        </select>
                                    </div>

                                    <!-- ุงุฎุชูุงุฑ ุงูููู ุงูุฌุฏูุฏ -->
                                    <div class="mb-3">
                                        <label for="newDayOther" class="form-label">ุงูููู ุงูุฌุฏูุฏ</label>
                                        <input type="date" class="form-control" id="newDayOther"
                                            [(ngModel)]="newDateOtherDay" name="newDayOther">
                                    </div>
                                </form>
                            </div>

                            <!-- Footer -->
                            <div class="modal-footer">
                                <button type="button" class="btn-close-book" data-bs-dismiss="modal">
                                    ุฅูุบุงุก
                                </button>
                                <button type="button" class="btn btn-primary text-white" (click)="rescheduleOtherDay()"
                                    data-bs-dismiss="modal">
                                    ุชุฃููุฏ ุงูุชุฃุฌูู
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- <button class="btn btn-ghost" data-bs-toggle="modal" data-bs-target="#changeBookingModal"
                    title="ุชุบููุฑ ููุนุงุฏ ุจุฏุงูุฉ / ููู ุงูุญุฌุฒ">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                        <circle cx="12" cy="12" r="9" stroke="currentColor" stroke-width="2" />
                        <path d="M12 7v5l3 3" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                            stroke-linejoin="round" />
                        <path d="M16 5l3-3" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                    </svg>
                    ุชุบููุฑ ููุนุงุฏ ุจุฏุงูุฉ / ููู ุงูุญุฌุฒ
                </button> -->

                <!-- ุงูููุฏุงู -->
                <!-- <div class="modal fade" id="changeBookingModal" tabindex="-1" aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content">


                            <div class="modal-header">
                                <h5 class="modal-title">ุชุบููุฑ ููุนุงุฏ ุงูุญุฌุฒ</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"
                                    aria-label="ุฅุบูุงู"></button>
                            </div>


                            <div class="modal-body">
                                <form>

                                    <div class="mb-3">
                                        <label for="day" class="form-label">ุงูููู</label>
                                        <input type="date" class="form-control" id="day" [(ngModel)]="day" name="day"
                                            required>
                                    </div>


                                    <div class="mb-3">
                                        <label for="startTime" class="form-label">ููุช ุงูุจุฏุงูุฉ</label>
                                        <input type="time" class="form-control" id="startTime" [(ngModel)]="startTime"
                                            name="startTime" step="60" required>
                                    </div>


                                    <div class="mb-3">
                                        <label for="endTime" class="form-label">ููุช ุงูููุงูุฉ</label>
                                        <input type="time" class="form-control" id="endTime" [(ngModel)]="endTime"
                                            name="endTime" step="60" required>
                                    </div>
                                </form>


                                <div *ngIf="modalMessage" class="alert mt-2"
                                    [ngClass]="modalSuccess ? 'alert-success' : 'alert-danger'">
                                    {{ modalMessage }}
                                </div>
                            </div>


                            <div class="modal-footer">
                                <button type="button" class="btn-close-book" data-bs-dismiss="modal">ุฅุบูุงู</button>
                                <button type="button" class="btn btn-primary text-white" (click)="saveChanges()">
                                    ุญูุธ
                                </button>
                            </div>
                        </div>
                    </div>
                </div> -->

            </div>
        </div>


        <div class="card">
            <table aria-label="ูุงุฆูุฉ ุงูุฃูุณุงู" class="table ">
                <thead>
                    <tr>
                        <!-- <th class="chk-col">
                            <input type="checkbox" id="selectAll" title="ุชุญุฏูุฏ ุงููู" [checked]="isAllSelected()"
                                (change)="toggleAll(getChecked($event))" />
                        </th> -->
                        <th style="text-align: center">ุงูุงุณู</th>
                        <th style="text-align: right">ุงููุงุชู</th>
                        <th style="text-align: center">ุงูุญุงูุฉ</th>
                        <th style="text-align: center">ุงูููุช ุงููุชููุน</th>
                        <th style="text-align: center">ุชุงุฑูุฎ ุงูููู</th>
                        <th style="text-align: center">ููุน ุงูุฒูุงุฑุฉ</th>
                        <th class="right-col">ุฑูู ุงูุฏูุฑ</th>
                    </tr>
                </thead>
                <tbody id="tableBody">
                    <tr *ngFor="let r of rows">
                        <!-- โ ุนููุฏ ุงูุชุดูู ุจููุณ -->
                        <!-- <td class="chk-col">
                            <input type="checkbox" [checked]="selectedRows.has(r.id)"
                                (change)="toggleRow(r.id, getChecked($event))" />
                        </td> -->

                        <!-- ุงูุงุณู + ุงูุฃููููุฉ -->
                        <td style="text-align: center">
                            <span [innerText]="r.patientName"></span>
                        </td>

                        <td dir="ltr">{{ r.phone }}</td>
                        <td style="text-align: center">
                            {{ r.status }}
                        </td>
                        <td style="text-align: center">
                            <span style="direction: ltr; unicode-bidi: embed;">
                                {{ r.estimatedTime }}
                            </span>
                        </td>
                        <td style="text-align: center">{{ r.date }}</td>
                        <td style="text-align: center">{{ r.appointmentType }}</td>
                        <td class="right-col">{{ r.queueNumber }}</td>

                        <!-- โ ุฒุฑุงุฑ ุชู ุงููุดู -->
                        <td>
                            <button class="btn" (click)="completeAppointment(r.id)"
                                [disabled]="r.status === 'Completed' || r.status === 'Cancelled'">
                                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="20" fill="white"
                                    viewBox="0 0 24 24">
                                    <path
                                        d="M20.285 6.709a1 1 0 0 0-1.414-1.418l-9.192 9.2-4.243-4.243a1 1 0 1 0-1.414 1.415l5 5a1 1 0 0 0 1.414 0l10-10z" />
                                </svg>

                                ุชู ุงููุดู
                            </button>
                        </td>

                        <!-- โ ุฒุฑุงุฑ ุฅูุบุงุก ุงูุญุฌุฒ -->
                        <td>
                            <button class="btn-close-book" (click)="cancelAppointment(r.id)"
                                [disabled]="r.status === 'Cancelled'">
                                <svg width="18" height="20" viewBox="0 0 24 24" fill="none"
                                    xmlns="http://www.w3.org/2000/svg">
                                    <path d="M18 6L6 18M6 6l12 12" stroke="white" stroke-width="1.6"
                                        stroke-linecap="round" stroke-linejoin="round" />
                                </svg>
                                ุฅูุบุงุก ุงูุญุฌุฒ
                            </button>

                        </td>

                    </tr>


                </tbody>
            </table>



        </div>




        <!-- ุฌุฏูู ุงูููุงุนูุฏ ุงููุคุฌูุฉ ูููู ุขุฎุฑ -->
        <!-- <div class="card mt-4">
            <h5 class="p-3">ุงูููุงุนูุฏ ุงููุคุฌูุฉ ูููู ุขุฎุฑ</h5>
            <table aria-label="ุงูููุงุนูุฏ ุงููุคุฌูุฉ" class="table table-striped">
                <thead>
                    <tr>
                        <th style="text-align: center">ุงูุงุณู</th>
                        <th style="text-align: right">ุงููุงุชู</th>
                        <th style="text-align: center">ุงูุชุงุฑูุฎ ุงูุฃุตูู</th>
                        <th style="text-align: center">ุงูููู ุงูุฌุฏูุฏ</th>
                        <th style="text-align: center">ุงูููุช ุงูุฌุฏูุฏ</th>
                        <th style="text-align: center">ููุน ุงูุฒูุงุฑุฉ</th>
                        <th style="text-align: center">ุฑูู ุงูุฏูุฑ</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let a of rescheduledAppointmentsDay">
                        <td style="text-align: center">{{ a.patientName }}</td>
                        <td dir="ltr">{{ a.phone }}</td>
                        <td style="text-align: center">{{ a.date | date:'yyyy-MM-dd' }}</td>
                        <td style="text-align: center">{{ a.estimatedTime | date:'yyyy-MM-dd' }}</td>
                        <td style="text-align: center">{{ a.estimatedTime | date:'HH:mm' }}</td>
                        <td style="text-align: center">{{ a.appointmentType }}</td>
                        <td style="text-align: center">{{ a.queueNumber }}</td>

                    </tr>
                </tbody>
            </table>
        </div> -->

    </div>

    <div class="toast" id="toast"></div>
    <p class="scroll-hint">โ ุงุณุญุจ ูููููู/ุงูุดูุงู ูุฑุคูุฉ ุจุงูู ุงูุฃุนูุฏุฉ</p>

</section>